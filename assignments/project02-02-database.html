<!doctype html>
<html lang="en">
    <head>
            <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/fall2025/assets/images/favicon.ico" type="image/x-icon">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <title>Database</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="/fall2025/assets/main.css">
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163192686-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-163192686-1');
    </script>
    </head>
    <body class="two-column">
        <!-- banner -->
<header>
    <section>
        <h1 class="desktop"><a href="/fall2025/">CSCI 338: Fall 2025</a></h1>
        <h2 class="desktop">Software Engineering</h2>
        <a class="mobile" href="#">
            <i class="menu-toggle fas fa-bars"></i>
        </a>
        <h1 class="mobile">CSCI 338: Fall 2025</h1>
    </section>
    <img src="https://communication.unca.edu/wp-content/themes/tin/assets/logo.svg" />
</header>
        <nav>
    <ul>
        <li ><a href="/fall2025/syllabus/">Syllabus</a>
        </li>
        <li ><a
                href="/fall2025/">Schedule</a></li>
        <li class="active" ><a
                href="/fall2025/assignments/">Assignments</a></li>
        <li ><a
                href="/fall2025/resources/">Resources</a></li>
        <li ><a href="/fall2025/repos/">Repos</a>
        </li>
        <li><a href="https://drive.google.com/drive/folders/1iI-Iz85UpjGyuu9q_reuq4vT6hC4AEQq?usp=drive_link"
                target="_blank">Videos</a></li>
    </ul>
</nav>
        <main>
            <aside>
                
                
                <ol class="side-menu">
  <li><a href="#id_1-introduction">1. Introduction</a></li>
  <li><a href="#id_2-create-a-new-branch">2. Create a New Branch</a></li>
  <li><a href="#id_3-create-database-dockerfile">3. Create Database Dockerfile</a></li>
  <li><a href="#id_4-create-env-file">4. Create .env File</a></li>
  <li><a href="#id_5-push-your-new-branch">5. Push your new branch</a></li>
</ol>

            </aside>
            <article>
                


    <h1>
        <a href="../assignments/project02">Project 2</a> >
        Database
    </h1>
    
 
                <p>
    
    
    
</p>

<h2 id="id_1-introduction">1. Introduction</h2>

<p>We are now going to start building our Docker containers. This project uses a <strong>three-container architecture</strong> where each service runs in its own isolated container:</p>

<ol>
  <li><strong>Database Container</strong> - PostgreSQL database for storing application data</li>
  <li><strong>Backend Container</strong> - FastAPI server that handles API requests and communicates with the database</li>
  <li><strong>Frontend Container</strong> - React application that provides the user interface</li>
</ol>

<p><strong>Why three containers?</strong></p>
<ul>
  <li><strong>Separation of concerns</strong> - Each service has its own environment and dependencies</li>
  <li><strong>Scalability</strong> - You can scale each service independently</li>
  <li><strong>Isolation</strong> - Problems in one container don’t affect the others</li>
  <li><strong>Development</strong> - Each service can be developed and tested independently</li>
</ul>

<p>The containers communicate with each other through Docker’s internal networking, which we’ll configure in the <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> file.</p>

<p><strong>Architecture Diagram:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────────────────────────────────────────────────────┐
│                    Your Laptop                              │
│                                                             │
│  ┌──────────────┐         ┌──────────────┐                  │
│  │   Browser    │────────▶│  Frontend    │                  │
│  │              │  :5173  │  Container   │                  │
│  │ localhost    │◀────────│  (React)     │                  │
│  └──────────────┘         └──────┬───────┘                  │
│                                  │                          │
│                                  │ HTTP Requests            │
│                                  │ (localhost:8000)         │
│                                  ▼                          │
│                          ┌──────────────┐                   │
│                          │   Backend    │                   │
│                          │  Container   │                   │
│                          │  (FastAPI)   │                   │
│                          └──────┬───────┘                   │
│                                  │                          │
│                                  │ SQL Queries              │
│                                  │ (internal Docker network)│
│                                  ▼                          │
│                          ┌──────────────┐                   │
│                          │  Database    │                   │
│                          │  Container   │                   │
│                          │ (PostgreSQL) │                   │
│                          └──────────────┘                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘

Port Mappings:
- Frontend:  localhost:5173  ←→  Container:5173
- Backend:   localhost:8000  ←→  Container:8000
- Database:  localhost:5433  ←→  Container:5432 (internal only)
</code></pre></div></div>

<p><strong>How it works:</strong></p>
<ul>
  <li>Your <strong>browser</strong> connects to the frontend container on port 5173</li>
  <li>The <strong>frontend</strong> makes HTTP requests to the backend on port 8000</li>
  <li>The <strong>backend</strong> communicates with the database using Docker’s internal network</li>
  <li>All three containers run simultaneously on your laptop via Docker</li>
</ul>

<h2 id="id_2-create-a-new-branch">2. Create a New Branch</h2>

<p>Before you begin, create a new Git branch for this work:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git checkout <span class="nt">-b</span> system-setup
</code></pre></div></div>

<p><strong>Why create a branch?</strong></p>
<ul>
  <li>Keeps your work organized</li>
  <li>Allows you to experiment without affecting the main branch</li>
  <li>Makes it easier to review changes before merging</li>
</ul>

<blockquote class="info">
  <h3 id="id_-before-you-move-on"><i class="fa-regular fa-circle-check"></i> Before you move on</h3>
  <p>Verify that you’re on your new branch – not main.</p>
</blockquote>

<h2 id="id_3-create-database-dockerfile">3. Create Database Dockerfile</h2>

<p>Create <code class="language-plaintext highlighter-rouge">database/Dockerfile</code> with the following <strong>exact</strong> content:</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> postgres:15</span>
<span class="k">ENV</span><span class="s"> POSTGRES_PASSWORD=postgres</span>
</code></pre></div></div>

<p><strong>Why this works:</strong></p>
<ul>
  <li>Uses PostgreSQL 15 (stable version)</li>
  <li>Sets default password for development</li>
  <li>PostgreSQL will create databases as needed</li>
</ul>

<h2 id="id_4-create-env-file">4. Create .env File</h2>

<p>Create a <code class="language-plaintext highlighter-rouge">.env</code> file at the root of your project with the following content:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Local Docker DB connection string:</span>
<span class="nv">DATABASE_URL</span><span class="o">=</span>postgresql+asyncpg://postgres:postgres@db:5432/todo_db
</code></pre></div></div>

<p><strong>Why this matters:</strong></p>
<ul>
  <li>The <code class="language-plaintext highlighter-rouge">.env</code> file stores environment variables for local development that are likely to change when you deploy your server to production.</li>
  <li>For now, our <code class="language-plaintext highlighter-rouge">.env</code> will only store our database connection string (top secret), but we can also add additional variables to this as needed (e.g., API keys, configurationg settings, etc.)</li>
  <li>This connection string points to the PostgreSQL database that will be running on Docker once you build your docker container.</li>
  <li>The format <code class="language-plaintext highlighter-rouge">postgresql+asyncpg://</code> is required for SQLAlchemy with asyncpg</li>
  <li>The <code class="language-plaintext highlighter-rouge">@db:5432</code> hostname refers to the database service name in <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code></li>
</ul>

<blockquote class="info">
  <h3 id="id_-before-you-move-on-1"><i class="fa-regular fa-circle-check"></i> Before you move on</h3>
  <ul>
    <li>Verify your <code class="language-plaintext highlighter-rouge">.env</code> file exists at the project root and contains the DATABASE_URL.</li>
    <li>Also verify that your file structure looks like the one below:</li>
  </ul>

  <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>project02-fall2025
├── .env            <span class="c"># new (and excluded from version control via .gitignore)</span>
├── .git/
├── .gitignore
├── backend/
│   └── models/
├── database/
│   └── Dockerfile  <span class="c"># new</span>
├── README.md
└── ui/
    └── src/
</code></pre></div>  </div>
</blockquote>

<h2 id="id_5-push-your-new-branch">5. Push your new branch</h2>
<p>Go ahead and push your new branch to GitHub.</p>

<blockquote class="info">
  <h3 id="id_-before-you-move-on-2"><i class="fa-regular fa-circle-check"></i> Before you move on</h3>
  <p>Verify that your new branch is on GitHub.
Don’t worry about making a PR or merging anything yet. We’ll address that later.</p>
</blockquote>

<hr />

<p><a href="project02">← Back to Project 2 Instructions</a></p>



            </article>  
        </main>
        <footer>
            <p>    
                Department of Computer Science, UNC Asheville
            </p>
        </footer>
        
        <script type="text/javascript" src="/fall2025/assets/js/main.js"></script>
<script type="text/javascript" src="/fall2025/assets/js/copy-code.js"></script>

<!-- <script>
    //little bit of a hack:
    const scrollLeft = () => {
        //console.log('scrollLeft');
        document.documentElement.scrollLeft = 0;
    };
    setTimeout(scrollLeft, 100);
</script> -->
        
        <script>
            window.h_max = "2";
        </script>
        
        <script type="text/javascript" src="/fall2025/assets/js/scrollspy.js"></script>
        <script type="text/javascript" src="/fall2025/assets/js/expandable.js"></script>
    </body>
</html>