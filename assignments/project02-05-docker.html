<!doctype html>
<html lang="en">
    <head>
            <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/fall2025/assets/images/favicon.ico" type="image/x-icon">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <title>Docker Compose File + Build Your Containers</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="/fall2025/assets/main.css">
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163192686-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-163192686-1');
    </script>
    </head>
    <body class="two-column">
        <!-- banner -->
<header>
    <section>
        <h1 class="desktop"><a href="/fall2025/">CSCI 338: Fall 2025</a></h1>
        <h2 class="desktop">Software Engineering</h2>
        <a class="mobile" href="#">
            <i class="menu-toggle fas fa-bars"></i>
        </a>
        <h1 class="mobile">CSCI 338: Fall 2025</h1>
    </section>
    <img src="https://communication.unca.edu/wp-content/themes/tin/assets/logo.svg" />
</header>
        <nav>
    <ul>
        <li ><a href="/fall2025/syllabus/">Syllabus</a>
        </li>
        <li ><a
                href="/fall2025/">Schedule</a></li>
        <li class="active" ><a
                href="/fall2025/assignments/">Assignments</a></li>
        <li ><a
                href="/fall2025/resources/">Resources</a></li>
        <li ><a href="/fall2025/repos/">Repos</a>
        </li>
        <li><a href="https://drive.google.com/drive/folders/1iI-Iz85UpjGyuu9q_reuq4vT6hC4AEQq?usp=drive_link"
                target="_blank">Videos</a></li>
    </ul>
</nav>
        <main>
            <aside>
                
                
                <ol class="side-menu">
  <li><a href="#id_what-is-docker-compose">What is Docker Compose?</a></li>
  <li><a href="#id_create-docker-composeyaml">Create docker-compose.yaml</a></li>
  <li><a href="#id_build-and-start-your-containers">Build and Start Your Containers</a>
    <ol>
      <li><a href="#id_verify-your-backend-endpoints">Verify your backend endpoints</a></li>
      <li><a href="#id_-before-you-move-on"> Before you move on</a></li>
    </ol>
  </li>
  <li><a href="#id_commit-and-push">Commit and Push</a>
    <ol>
      <li><a href="#id_-before-you-move-on-1"> Before you move on</a></li>
    </ol>
  </li>
</ol>

            </aside>
            <article>
                


    <h1>
        <a href="../assignments/project02">Project 2</a> >
        Docker Compose File + Build Your Containers
    </h1>
    
 
                <p>
    
    
    
</p>

<h2 id="id_what-is-docker-compose">What is Docker Compose?</h2>

<p><strong>Docker Compose</strong> is a tool that lets you define and run multiple Docker containers together with a single configuration file. Instead of running each container separately with <code class="language-plaintext highlighter-rouge">docker run</code>, you can use <code class="language-plaintext highlighter-rouge">docker-compose up</code> to start all your services at once.</p>

<p><strong>Why use Docker Compose?</strong></p>

<ul class="compact">
  <li><strong>Orchestration</strong> - Manages multiple containers (database, backend, frontend) as one application</li>
  <li><strong>Networking</strong> - Automatically creates a network so containers can communicate</li>
  <li><strong>Dependencies</strong> - Ensures services start in the correct order (e.g., database before backend)</li>
  <li><strong>Volume Management</strong> - Handles data persistence and file mounting</li>
  <li><strong>Environment Variables</strong> - Centralized configuration for all services</li>
</ul>

<p><strong>Important: Docker Compose is for Development Only</strong>
Docker Compose is <strong>not used in production</strong> environments. In production, each service typically runs in its own container on separate machines or cloud instances. The <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> file you create here is <strong>only for local development</strong> to make it easy to run your entire stack with one command</p>

<h2 id="id_create-docker-composeyaml">Create docker-compose.yaml</h2>

<p>Create <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> in the root directory:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="c1"># PostgreSQL Database Service</span>
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span>
      <span class="na">context</span><span class="pi">:</span> <span class="s">./database</span>
      <span class="na">dockerfile</span><span class="pi">:</span> <span class="s">Dockerfile</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">todo_db</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">POSTGRES_USER</span><span class="pi">:</span> <span class="s">postgres</span>
      <span class="na">POSTGRES_PASSWORD</span><span class="pi">:</span> <span class="s">postgres</span>
      <span class="na">POSTGRES_DB</span><span class="pi">:</span> <span class="s">todo_db</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5433:5432"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">postgres_data:/var/lib/postgresql/data</span>
    <span class="na">healthcheck</span><span class="pi">:</span>
      <span class="na">test</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">CMD-SHELL"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">pg_isready</span><span class="nv"> </span><span class="s">-U</span><span class="nv"> </span><span class="s">postgres</span><span class="nv"> </span><span class="s">-d</span><span class="nv"> </span><span class="s">todo_db"</span><span class="pi">]</span>
      <span class="na">interval</span><span class="pi">:</span> <span class="s">2s</span>
      <span class="na">timeout</span><span class="pi">:</span> <span class="s">3s</span>
      <span class="na">retries</span><span class="pi">:</span> <span class="m">10</span>
      <span class="na">start_period</span><span class="pi">:</span> <span class="s">10s</span>

  <span class="c1"># FastAPI Backend Service</span>
  <span class="na">backend</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span>
      <span class="na">context</span><span class="pi">:</span> <span class="s">./backend</span>
      <span class="na">dockerfile</span><span class="pi">:</span> <span class="s">Dockerfile</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">todo_backend</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">DATABASE_URL</span><span class="pi">:</span> <span class="s">${DATABASE_URL:-postgresql+asyncpg://postgres:postgres@db:5432/todo_db}</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8000:8000"</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="na">db</span><span class="pi">:</span>
        <span class="na">condition</span><span class="pi">:</span> <span class="s">service_healthy</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./backend:/app</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">poetry run uvicorn server:app --host 0.0.0.0 --port 8000 --reload</span>

  <span class="c1"># React Frontend Service</span>
  <span class="na">frontend</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span>
      <span class="na">context</span><span class="pi">:</span> <span class="s">./ui</span>
      <span class="na">dockerfile</span><span class="pi">:</span> <span class="s">Dockerfile</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">todo_frontend</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5173:5173"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./ui:/app</span>
      <span class="pi">-</span> <span class="s">/app/node_modules</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">VITE_API_URL=http://localhost:8000</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">backend</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">npm run dev -- --host 0.0.0.0</span>

<span class="na">volumes</span><span class="pi">:</span>
  <span class="na">postgres_data</span><span class="pi">:</span>
</code></pre></div></div>

<h2 id="id_build-and-start-your-containers">Build and Start Your Containers</h2>

<p>Now that you’ve created your <code class="language-plaintext highlighter-rouge">docker-compose.yaml</code> file, you can build and start all your containers in detached mode (so that your Terminal isn’t tied up):</p>

<p>Make sure that Docker Desktop is running. Then, issue the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># From the root of your project (where docker-compose.yaml is located)</span>
docker-compose up <span class="nt">-d</span>
</code></pre></div></div>

<p><strong>What you should see:</strong></p>

<ul>
  <li>Database container starting and becoming healthy</li>
  <li>Backend container starting and connecting to the database</li>
  <li>Frontend container starting and running Vite dev server</li>
  <li>All services running and accessible:
    <ul>
      <li>Frontend: <a href="http://localhost:5173" target="_blank">http://localhost:5173</a></li>
      <li>Backend API: <a href="http://localhost:8000" target="_blank">http://localhost:8000</a></li>
      <li>Backend Docs: <a href="http://localhost:8000/docs" target="_blank">http://localhost:8000/docs</a></li>
    </ul>
  </li>
</ul>

<h3 id="id_verify-your-backend-endpoints">Verify your backend endpoints</h3>
<p>Test all endpoints from the command line:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Make sure Docker is running (docker-compose up)</span>
<span class="c"># The server should already be running at http://localhost:8000</span>

<span class="c"># Test GET all</span>
curl http://localhost:8000/todos

<span class="c"># Test POST</span>
curl <span class="nt">-X</span> POST http://localhost:8000/todos <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"title": "Test", "description": "Test todo"}'</span>

<span class="c"># Test GET one (use ID from POST response)</span>
curl http://localhost:8000/todos/1

<span class="c"># Test PATCH</span>
curl <span class="nt">-X</span> PATCH http://localhost:8000/todos/1 <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"title": "Updated", "completed": true}'</span>

<span class="c"># Test DELETE</span>
curl <span class="nt">-X</span> DELETE http://localhost:8000/todos/1

<span class="c"># View API documentation</span>
<span class="c"># Open http://localhost:8000/docs in your browser</span>
</code></pre></div></div>

<blockquote class="info">
  <h3 id="id_-before-you-move-on"><i class="fa-regular fa-circle-check"></i> Before you move on</h3>
  <p>Verify that all three containers are running:</p>
  <ul>
    <li>Check that you can access http://localhost:5173 (frontend)</li>
    <li>Check that you can access http://localhost:8000/docs (backend API documentation)</li>
    <li>Verify your containers are running with: <code class="language-plaintext highlighter-rouge">docker ps</code></li>
  </ul>
</blockquote>

<h2 id="id_commit-and-push">Commit and Push</h2>
<p>Go ahead and commit / push your changes to git / GitHub.</p>

<blockquote class="info">
  <h3 id="id_-before-you-move-on-1"><i class="fa-regular fa-circle-check"></i> Before you move on</h3>
  <p>Verify that all your new code is on GitHub.</p>
</blockquote>

<hr />

<p><a href="project02">← Back to Project 2 Instructions</a></p>



            </article>  
        </main>
        <footer>
            <p>    
                Department of Computer Science, UNC Asheville
            </p>
        </footer>
        
        <script type="text/javascript" src="/fall2025/assets/js/main.js"></script>
<script type="text/javascript" src="/fall2025/assets/js/copy-code.js"></script>

<!-- <script>
    //little bit of a hack:
    const scrollLeft = () => {
        //console.log('scrollLeft');
        document.documentElement.scrollLeft = 0;
    };
    setTimeout(scrollLeft, 100);
</script> -->
        
        <script type="text/javascript" src="/fall2025/assets/js/scrollspy.js"></script>
        <script type="text/javascript" src="/fall2025/assets/js/expandable.js"></script>
    </body>
</html>